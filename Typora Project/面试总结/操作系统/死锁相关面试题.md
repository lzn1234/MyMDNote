#### 什么是死锁

两个或两个以上的并发进程，每个进程在持有资源的同时有需要等待其他进程释放它们所持有的资源，这种因资源竞争而产生的进程阻塞，若无外力作用将一直保持下去，这就是死锁



#### 死锁产生的必要条件（四个缺一不可）

1. **互斥条件**：当一个资源被一个线程持有时，别的线程不能使用该资源。（一个资源只能在一个时间段内只能被一个线程持有使用）。
2. **不剥夺条件（不可抢占）**：一个进程不能从**资源占有者**的手中夺取资源。
3. **占有且等待（请求和保持条件）**：进程在请求其他资源的同时也会保持原有资源的占有，如果请求的资源被其他线程占有，该线程就会进入阻塞状态，直到获取到请求的资源。
4. **循环等待（环路等待条件）**：多个线程等待其他线程所占有的资源从而形成一个循环的关系



#### 如何预防死锁

因为死锁是必须同时满足四个条件才会产生，所以只需破坏其中一个条件就可以解除死锁

一般不破坏互斥条件，因为某些资源是必须互斥使用的，如打印机设备等

- 破坏**不可抢占**条件： 当线程获取到一部分资源时，去申请另一个资源时，如果申请不到，便会主动释放它所占有的所有资源。

- 破坏**占有且等待**条件：每个请求一次性申请所有的资源，如果申请不到，就保持等待。

- 破坏**循环等待**条件：每个资源标上序号，按序线性化申请资源，就可以避免环路条件。

  

#### 如何避免死锁（银行家算法）







#### 预防和避免的区别：

预防是操作系统对用户程序进行限制（限制其申请资源），影响资源利用率和系统吞吐量。

避免是设置较为宽松的条件，在资源的动态分配过程中，用某种方法去防止系统进入不安全状态。

